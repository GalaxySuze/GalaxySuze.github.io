<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>张阿简博客</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="Kill Time, Or Kiss Time"/>
<meta name="keywords" content="Kill Time, Or Kiss Time"/>
<link rel="shortcut icon" href="https://zhangajian.com/favicon.ico">
<link rel="stylesheet" href="https://zhangajian.com/styles/main.css">


<!-- Comment -->

    
        <link href="https://cdn.bootcss.com/gitalk/1.5.0/gitalk.min.css" rel="stylesheet">
    

    


<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">



</head>
<body class="home-template">
<div id="page" class="site">

    <header class="site-header">
    <h1 class="site-title"><a href="https://zhangajian.com">张阿简博客</a></h1>
    <a class="sidebar-toggle"><span class="screen-reader-text">Menu</span><span class="icon" aria-hidden="true"></span></a>
</header>

<aside class="sidebar">
    <div class="sidebar-scrollable">
        <div class="inner">
            <div class="widget-area">
                <!-- 菜单 -->
                <nav class="site-navigation">
                    <h2>张阿简博客</h2>
                    <ul class="menu">
                        
                            <li class="menu-item home current-menu-item">
                                <a href="/"
                                
                                >首页</a>
                            </li>
                        
                            <li class="menu-item home current-menu-item">
                                <a href="/archives"
                                
                                >归档</a>
                            </li>
                        
                            <li class="menu-item home current-menu-item">
                                <a href="https://zhangajian.com/post/tu-lang/"
                                
                                >图廊</a>
                            </li>
                        
                            <li class="menu-item home current-menu-item">
                                <a href="https://zhangajian.com/post/you-lian/"
                                
                                >友链</a>
                            </li>
                        
                    </ul>
                </nav>

                <section class="widget widget-about">
                    <h2 class="widget-title">关于</h2>
                    <p>Kill Time, Or Kiss Time</p>
                </section>

                <section class="widget widget-tags">
                    <h2 class="widget-title">标签</h2>
                    <div class="tagcloud">
                        
                            <a href="https://zhangajian.com/tag/-6RH_hF5V" class="button">
                                Gridea
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/ISfc6GmDv1" class="button">
                                主题
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/wa6VE0See" class="button">
                                原创
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/FUUIh5fRu" class="button">
                                阅读
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/fb3yEkNaz" class="button">
                                Supervisor
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/laravel" class="button">
                                Laravel
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/TnE9j9p54" class="button">
                                生活
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/2Lrsz8nQ5" class="button">
                                Java
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/linux" class="button">
                                Linux
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/Q1TPBCeTZ" class="button">
                                Minecraft
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/screen" class="button">
                                screen
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/R9XMeHPGI" class="button">
                                Mac
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/7GuO-rABn" class="button">
                                Certbot
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/32-ELgkvl" class="button">
                                HTTPS
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/nginx" class="button">
                                Nginx
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/gWr_Ce0M-" class="button">
                                PHP
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/WU4oQ_US9" class="button">
                                WordPress
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/zpAo_gez-" class="button">
                                Mysql
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/XljxheWyB" class="button">
                                Composer
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/Zo5YAjmh-" class="button">
                                设计模式
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                            <a href="https://zhangajian.com/tag/f8yREx6Zn" class="button">
                                Redis
                                <span aria-hidden="true"><span class="line left"></span><span class="line top"></span><span class="line right"></span><span class="line bottom"></span></span>
                            </a>
                        
                    </div>
                </section>

            </div>
            <a class="sidebar-toggle"><span class="screen-reader-text">Close</span><span class="icon" aria-hidden="true"></span></a>
        </div>
    </div>
</aside>


    <main class="site-main">
        <div class="site-content">
            <article class="post tag-getting-started">
                <header class="cover post-header">
                    <div class="cover-bg" >

                        
                            <img srcset="https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-63.jpg 300w, https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-63.jpg 600w, https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-63.jpg 800w, https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-63.jpg 1600w, https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-63.jpg 2000w"
                                 sizes="100vw" src="https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-63.jpg" alt="在阿里云上部署WordPress"/>
                        

                    </div>
                    <div class="cover-content">
                        <div class="inner">
                            <div class="post-tags">
                                
                                    
                                        <a href="https://zhangajian.com/tag/gWr_Ce0M-">PHP&nbsp;&nbsp;</a>
                                    
                                        <a href="https://zhangajian.com/tag/WU4oQ_US9">WordPress&nbsp;&nbsp;</a>
                                    
                                        <a href="https://zhangajian.com/tag/nginx">Nginx&nbsp;&nbsp;</a>
                                    
                                        <a href="https://zhangajian.com/tag/linux">Linux&nbsp;&nbsp;</a>
                                    
                                        <a href="https://zhangajian.com/tag/wa6VE0See">原创&nbsp;&nbsp;</a>
                                    
                                
                            </div>
                            <h1 class="post-title" style="color: #ffffff; font-size: 3em;">在阿里云上部署WordPress</h1>
                            <div class="post-meta">
                                <span class="post-meta-wrap">
                                    <img class="author-avatar"
                                         srcset="https://zhangajian.com/media/images/avatar.png, https://zhangajian.com/media/images/avatar.png 2x"
                                         src="https://zhangajian.com/media/images/avatar.png" alt=""/>
                                    <span class="post-author">1410字</span>
                                    <time class="published"
                                          datetime="2018-10-18">2018-10-18</time>
                                </span>
                                <div class="reading-time">7 min read</div>
                            </div>
                            <a href="#post-content" class="arrow-down" data-scroll><span class="screen-reader-text">Scroll Down</span></a>
                        </div>
                    </div>
                </header>
                <div class="inner">

                    <div id="post-content" class="post-content">
                        <p style="margin-top: 62px;">
                            <p>最近刚好因为活动买了一台新的服务器，空着也空着，刚好可以用来搭博客使用，搭建博客这件事。之前也做过很多次，不管是用静态博客生成器，还是手写一个博客项目。都尝试过，思来想去，这次打算用用WordPress，听闻许久，也该用用看了。</p>
<!-- more -->
<h1 id="安装nginx">安装Nginx</h1>
<pre><code>yum -y install nginx
</code></pre>
<h1 id="安装mysql57">安装Mysql5.7</h1>
<ul>
<li>安装 mysql 官方 yum 源</li>
</ul>
<pre><code>rpm -ivh https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm
</code></pre>
<ul>
<li>查看 MySQL yum 源</li>
</ul>
<pre><code>yum list | grep mysql
</code></pre>
<p>发现只有 mysql80 的包，这是因为没有开启 mysql57 的包，关闭80包，开启57包。</p>
<pre><code>yum-config-manager --disable mysql80-community
yum-config-manager --enable mysql57-community
</code></pre>
<p>报错</p>
<pre><code>-bash: yum-config-manager: 未找到命令
</code></pre>
<p>这个是因为系统默认没有安装这个命令，这个命令在yum-utils 包里，可以通过命令yum -y install yum-utils 安装就可以了。</p>
<ul>
<li>安装 yum-utils 包</li>
</ul>
<pre><code>yum -y install yum-utils
</code></pre>
<ul>
<li>
<p>再次查看Mysql包列表出现57安装包</p>
</li>
<li>
<p>安装 Mysql57</p>
</li>
</ul>
<pre><code>yum -y install mysql-community-server
</code></pre>
<ul>
<li>启动 Mysql57服务</li>
</ul>
<pre><code class="language-shell">systemctl start mysqld
</code></pre>
<ul>
<li>查看初始密码</li>
</ul>
<pre><code>grep 'temporary password' /var/log/mysqld.log
</code></pre>
<ul>
<li>登录 Mysql，修改密码</li>
</ul>
<pre><code>mysql -uroot -p

set password for root@localhost = password('你的密码');
</code></pre>
<p>如果提示错误，那是因为 mysql57 对密码的复杂度进行了限制，依次执行下列命令，取消复杂度限制，再修改</p>
<pre><code>set global validate_password_policy=0;
set global validate_password_mixed_case_count=0;
set global validate_password_number_count=3;
set global validate_password_special_char_count=0;
set global validate_password_length=3;
</code></pre>
<p>提示错误</p>
<pre><code>[root@izuf6fco0zwyipdq9485s2z ~]# mysql -uroot -p
Enter password:
ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)
</code></pre>
<ul>
<li>如下操作修复</li>
</ul>
<pre><code># 先关闭服务
systemctl stop mysqld
# 跳过权限验证
mysqld --user=root --skip-grant-tables &amp;
# 登录
mysql -u root mysql
# 设置密码
UPDATE user SET authentication_string=PASSWORD('new password') where USER='root';
# 刷新设置
FLUSH PRIVILEGES;
</code></pre>
<h1 id="安装-php72">安装 PHP7.2</h1>
<p>php7.2 版本的 yum 源在 webtatic 上，但还有一部分需要依赖 epel-release 。EPEL(Extra Packages for Enterprise Linux )，是基于Fedora的一个项目，为“红帽系”的操作系统提供额外的软件包，适用于RHEL、CentOS和Scientific Linux。</p>
<ul>
<li>安装 epel-release</li>
</ul>
<pre><code>yum -y install epel-release
</code></pre>
<p>安装完成后，在 /etc/yum.repos.d 目录下，就会多一个 epel.repo 的文件，还有一个 testing 的测试文件。当系统通过 yum 进行安装软件时，如果需要 epel 里的扩展包，就会自动下载安装。</p>
<ul>
<li>安装 webtatic yum 源</li>
</ul>
<pre><code>rpm -ivh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm
</code></pre>
<p>安装完成后，在 /etc/yum.repos.d 目录下会多出 webtatic.repo 和 webtatic-archive.repo 两个文件，还有一个 testing 的测试文件。</p>
<ul>
<li>查看 php 可以安装的包</li>
</ul>
<pre><code> yum list | grep php72
</code></pre>
<p>上面这些 rpm 包就是 webtatic 的 yum 源里面的包啦。我们要安装的就是 php72 的核心包 mod_php72w 和核心扩展包 php72w-cli 、php72w-fpm、php72w-common、php72w-devel。其它扩展选项包请根据需要安装，例如需要 php72w-gd 后期可单独安装。</p>
<ul>
<li>安装php72</li>
</ul>
<pre><code>yum -y install mod_php72w php72w-cli php72w-fpm php72w-common php72w-devel
</code></pre>
<p>通过这种方式安装的 php72 的 php.ini 文件与我们认识的不太一样，它类似于 nginx.conf 存在一个主配置，通过类型 include 方法，包含指定文件夹下的模块配置文件。</p>
<ul>
<li>启动php-fpm</li>
</ul>
<pre><code>systemctl start php-fpm
</code></pre>
<h1 id="安装-wordpress">安装 WordPress</h1>
<ul>
<li>下载wordpress</li>
</ul>
<pre><code>wget https://cn.wordpress.org/wordpress-4.9.4-zh_CN.tar.gz
</code></pre>
<ul>
<li>解压到/home/目录下</li>
</ul>
<pre><code>tar -zxvf wordpress-4.9.4-zh_CN.tar.gz -C /home/
</code></pre>
<ul>
<li>登陆mysql并添加数据库，命名为wordpress</li>
</ul>
<pre><code>mysql -uroot -p
create database wordpress;
show databases;
</code></pre>
<ul>
<li>备份nginx的配置文件</li>
</ul>
<pre><code>cp /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak
</code></pre>
<ul>
<li>修改配置文件</li>
</ul>
<pre><code>vim /etc/nginx/conf.d/default.conf
</code></pre>
<p>重启Nginx服务时候报错，查看错误日志</p>
<pre><code>vim /var/log/nginx/error.log
2018/11/14 17:15:23 [emerg] 14151#0: bind() to 0.0.0.0:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to [::]:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to 0.0.0.0:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to [::]:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to 0.0.0.0:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to [::]:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to 0.0.0.0:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to [::]:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to 0.0.0.0:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: bind() to [::]:80 failed (98: Address already in use)
2018/11/14 17:15:23 [emerg] 14151#0: still could not bind()
</code></pre>
<p>看错误信息提示80端口已经被占用，无法重启Nginx服务，查看80端口进程是哪一个，并kill掉后，重启服务成功</p>
<pre><code>netstat -ntpl
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:9000          0.0.0.0:*               LISTEN      11333/php-fpm: mast
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      10363/nginx: master
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      15636/sshd
tcp6       0      0 :::3306                 :::*                    LISTEN      10604/mysqld
tcp6       0      0 :::80                   :::*                    LISTEN      10363/nginx: master
kill 10363
service nginx restart
</code></pre>
<ul>
<li>访问域名后显示WP的安装，我们点击进行填写mysql的用户名和密码</li>
</ul>
<p>数据用户名和密码填写后报错</p>
<blockquote>
<p>抱歉，我不能写入wp-config.php文件 ......</p>
</blockquote>
<p>查看wordpress文件夹，发现是权限问题</p>
<pre><code>ll /home | grep wordpress
drwxr-xr-x 5 nobody 65534 4096 2月   8 2018 wordpress
</code></pre>
<ul>
<li>查看用户组</li>
</ul>
<pre><code>grep -E '^(user|group)' /etc/php-fpm.d/www.conf
user = apache
group = apache
</code></pre>
<ul>
<li>设置访问权限</li>
</ul>
<pre><code>chown -R apache:apache /home/wordpress
</code></pre>
<h1 id="再次访问成功">再次访问成功！</h1>
<p>参考链接：<br>
<a href="https://laravel-china.org/articles/10803/">https://laravel-china.org/articles/10803/</a><br>
<a href="this-weekend-theres-a-lot-of-pits-on-the-website-for-a-friend-to-do">this-weekend-theres-a-lot-of-pits-on-the-website-for-a-friend-to-do</a><br>
<a href="https://blog.csdn.net/u011475134/article/details/80222098">https://blog.csdn.net/u011475134/article/details/80222098</a><br>
<a href="https://laravel-china.org/articles/17377#296073">https://laravel-china.org/articles/17377#296073</a></p>

                        </p>
                    </div>

                </div>
            </article>

            <section class="comments-area">
    <div class="inner">
        <h2 class="screen-reader-text">评论</h2>
        
            
                <div id="gitalk-container"></div>
            

            
        
    </div>
</section>


            
                <nav class="post-navigation">
                    <h2 class="screen-reader-text">Post navigation</h2>
                    <div class="nav-links">
                        <a href="https://zhangajian.com/post/fu-meng" class="nav-previous">
                            <div class="nav-bg" >
                                
                                    <img srcset="https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-65.jpg 300w, https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-65.jpg 600w, https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-65.jpg 800w, https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-65.jpg 1600w, https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-65.jpg 2000w" sizes="(max-width: 800px) 100vw, 50vw" src="https://blog-img-hosting.oss-cn-shanghai.aliyuncs.com/blog/article_cover/c-65.jpg" alt="图裂了"/>
                                
                            </div>
                            <div class="nav-inside">
                                <span class="nav-before">下一篇</span>
                                <span class="nav-title">伏梦</span>
                                <span class="nav-date">2018-09-10</span>
                            </div>
                        </a>
                    </div>
                </nav>
            

        </div>
    </main>

    <footer class="site-footer">
    <div class="inner">
        <!-- 社交 -->
        <div class="offsite-links">
            
                
            
                
            
                
            
                
            
                
            
        </div>

        <div class="site-info">
          THEME BY <a href="">Subtle</a><br/>
          Powered by <a target="_blank" href="https://gridea.dev/">Gridea</a>, © 2016 - 2019 Copyright 张阿简. All Rights Reserved. 自制主题<a target="_blank" href="https://github.com/GalaxySuze/gridea-theme-space">Space For Gridea</a>
        </div>
        <a href="#page" class="arrow-up" data-scroll><span class="screen-reader-text">Back to the top</span></a>
    </div>
</footer>


</div>

<script src="https://zhangajian.com/media/scripts/_core/plugins.js"></script>
<script src="https://zhangajian.com/media/scripts/_core/custom.js"></script>

<!-- highlight -->
<script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
<!-- Md5 Min JS -->
<script src="https://zhangajian.com/media/scripts/_vendors/md5.min.js"></script>

<script type="application/javascript">
    // 代码高亮
    hljs.initHighlightingOnLoad();

</script>



    
        <script src="https://cdn.bootcss.com/gitalk/1.5.0/gitalk.min.js"></script>
        <script>

            var gitalk = new Gitalk({
                clientID: 'f82af725bc4967d0e195',
                clientSecret: 'ea48b3d1484e6658649b97c3de3dd33e0ca89a64',
                repo: 'ZhangAJianBlogGitalk',
                owner: 'GalaxySuze',
                admin: ['GalaxySuze'],
                id: md5(location.pathname),      // Ensure uniqueness and length less than 50
                distractionFreeMode: false  // Facebook-like distraction free mode
            })

            gitalk.render('gitalk-container')

        </script>
    

    





</body>
</html>
